pipeline:
  prepare:
    image: docker.osgeo.org/postgis/build-test:trisquel3
    pull: true
    when:
      path: "doc/**"
    commands:
      - apt install -y dblatex texlive-xetex
      - ./autogen.sh
      - mkdir -p build-docs && cd build-docs
      - ../configure --without-pg
      - make postgis_revision.h
  build-html:
    image: docker.osgeo.org/postgis/build-test:trisquel3
    when:
      status: [ success ]
    commands:
      - cd build-docs
      - make docs
      - make -C doc check
      - make docs-localized
      - make -C doc/ check-localized
  build-pdf:
    image: docker.osgeo.org/postgis/build-test:trisquel3
    when:
      status: [ success ]
    commands:
      - cd build-docs
      - make -C doc/ pdf
